---
import { getCollection } from "astro:content";
import Container from "@components/Container.astro";
import PageLayout from "@layouts/PageLayout.astro";
import ArrowCard from "@components/ArrowCard.astro";
import Link from "@components/Link.astro";
import { dateRange } from "@lib/utils";
import { SITE, HOME, SOCIALS } from "@consts";

const projects = (await getCollection("projects"))
  .filter((project) => !project.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, SITE.NUM_PROJECTS_ON_HOMEPAGE);

const allwork = (await getCollection("work"))
  .sort(
    (a, b) =>
      new Date(b.data.dateStart).valueOf() -
      new Date(a.data.dateStart).valueOf()
  )
  .slice(0, SITE.NUM_WORKS_ON_HOMEPAGE);

const work = await Promise.all(
  allwork.map(async (item) => {
    const { Content } = await item.render();
    return { ...item, Content };
  })
);
---

<PageLayout title={HOME.TITLE} description={HOME.DESCRIPTION}>
  <Container>
    <section>
      <article class="space-y-8">
        <p class="animate font-semibold text-black dark:text-white">
          Front-end developer based in Lafayette, Louisiana.
        </p>
        <p class="animate">
          In 2023, I was waiting tables when I decided to start <Link
            href="https://www.theodinproject.com/"
            aria-label="Link to The Odin Project's Homepage"
            external>The Odin Project</Link
          >'s full-stack Javascript curriculum. I was attracted to the program's
          demanding, project-heavy, and self-directed approach.
        </p>
        <p class="animate">
          Much like <Link
            href="https://historiska.se/norse-mythology/odin-en/#:~:text=But%20he%20wanted%20to%20know,him"
            aria-label="Link to a page detailing the Norse God Odin's thirst for knowledge"
            external>The Odin Project's mascot</Link
          >, I recognized that, although I have access to a wealth of knowledge
          at a whim, it is precisely within the cozy confines of this abundance
          that one stagnates. The highly intimidating volume of concepts before
          me traced a long, arduous path that I <i>knew</i> was worth trekking. 5+
          courses, 140+ lessons, and 20+ projects later, I posses <b>strong</b> fundamentals
          in HTML, CSS, and JavaScript, and a solid grasp of Version Control (Git),
          Test-Driven-Development (Jest), and UI/UX Libraries (React).
        </p>
        <p class="animate">
          I've come a long way, but my journey in web development is just
          beginning. I'm eager for opportunities to continue honing my technical
          skills and creativity to contribute, innovate, and grow in
          environments with like-minded developers.
        </p>
      </article>
    </section>
    <div class="space-y-16 pt-8">
      <section class="animate space-y-6">
        <div class="flex flex-wrap gap-y-2 items-center justify-between pt-8">
          <h5 class="font-semibold text-black dark:text-white space-y-16">
            Work Experience
          </h5>
          <Link href="/work"> See all work </Link>
        </div>
        <ul class="flex flex-col space-y-4">
          {
            work.map((entry) => (
              <li>
                <div class="text-sm opacity-75">
                  {dateRange(entry.data.dateStart, entry.data.dateEnd)}
                </div>
                <div class="font-semibold text-black dark:text-white">
                  {entry.data.company}
                </div>
                <div class="text-sm opacity-75">{entry.data.role}</div>
                <article>
                  <entry.Content />
                </article>
              </li>
            ))
          }
        </ul>
      </section>

      <section class="animate space-y-6">
        <div class="flex flex-wrap gap-y-2 items-center justify-between">
          <h5 class="font-semibold text-black dark:text-white">
            Recent projects
          </h5>
          <Link href="/projects"> See all projects </Link>
        </div>
        <ul class="flex flex-col gap-4">
          {
            projects.map((project) => (
              <li>
                <ArrowCard entry={project} />
              </li>
            ))
          }
        </ul>
      </section>

      <section class="animate space-y-4">
        <h5 class="font-semibold text-black dark:text-white">Let's Connect</h5>
        <article>
          <p>If you'd like to get in touch, send me an email.</p>
        </article>
        <ul class="flex flex-wrap gap-2">
          {
            SOCIALS.map((SOCIAL) => (
              <li class="flex gap-x-2 text-nowrap">
                <Link
                  href={SOCIAL.HREF}
                  external
                  aria-label={`${SITE.NAME} on ${SOCIAL.NAME}`}
                >
                  {SOCIAL.NAME}
                </Link>
                {"/"}
              </li>
            ))
          }
          <li class="line-clamp-1">
            <Link
              href={`mailto:${SITE.EMAIL}`}
              aria-label={`Email ${SITE.NAME}`}
            >
              {SITE.EMAIL}
            </Link>
          </li>
        </ul>
      </section>
    </div>
  </Container>
</PageLayout>
